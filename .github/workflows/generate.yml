name: Generate

on:
    workflow_dispatch:
    schedule:
        - cron: "30 21 * * SUN"

jobs:
    build:
        runs-on: ubuntu-latest

        steps:
            - uses: actions/checkout@v2
            - uses: fregante/setup-git-user@v1
            - uses: actions/setup-node@v2
              with:
                  node-version: "14"
                  cache: 'yarn'
            - uses: actions/cache@v2
              with:
                  path: '**/node_modules'
                  key: ${{ runner.os }}-modules-${{ hashFiles('**/yarn.lock') }}
            - name: Generate
              run: |
                  yarn add moment lodash.shuffle && yarn generate
                  git add function/files && git commit -m "auto-gen timetable: $(date)" && git push
